define(function(){angular.module("coreModule").directive("showFocus",["$timeout",function(t){return function(e,s,n){e.$watch(n.showFocus,function(e){t(function(){e&&s.focus()})},!0)}}]).filter("encodeURIComponent",function(){return window.encodeURIComponent}).filter("decodeURIComponent",function(){return window.decodeURIComponent}).controller("playlistsController",["$scope","$rootScope","$translate","$translatePartialLoader","$filter","$http","$location","BPConfig","loadPlaylists","loadPlaylistsItems","reorderPlaylist","toastr",function(t,e,s,n,l,o,i,a,r,u,c,d){n.addPart("playlists"),s.refresh(),t.loading=!0;var f=i.search().playlist;t.Playlists=function(){r(a.apiUrl).then(function(e){var s=l("orderBy")(e,"title");t.playlists=s,"/"==i.url()&&i.path("/").search({playlist:s[0].id})})},t.PlaylistDetail=function(e){e?i.path("/").search({playlist:e.id}):void 0!=f&&u(a.apiUrl,f).then(function(e){t.PlaylistTitle=e.title,t.PlaylistId=e.id,t.ItemsResults=e.items,t.loading=!1})},t.saveChanges=function(){s("changes_saved").then(function(e){d.success(e+"."),t.show=!1}),c(a.apiUrl,f,t.ItemsResults)},t.changeItem=function(e,s){var n=t.ItemsResults.indexOf(s);if(e!=n+1){var l,o=t.ItemsResults.length-1;t.show=!0,l=1>=e?0:e>o?o:e-1;var i=[],a=0;angular.forEach(t.ItemsResults,function(e){i.push(n>l?a==l?s:l>a?e:a>n?e:t.ItemsResults[a-1]:a==l?s:n>a?e:l>a?t.ItemsResults[a+1]:a>n?e:t.ItemsResults[a-1]),a==o&&(t.ItemsResults=i),a++})}},t["delete"]=function(e){var s=t.ItemsResults.indexOf(e);-1!=s&&t.ItemsResults.splice(s,1),t.show=!0}}])});